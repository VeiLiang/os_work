#if !defined(__BG0806_CMOS_H_)
#define __BG0806_CMOS_H_
/*
attention bg0806:
	History 	  :
	1.Date			: 2016/11/07
	  Author	  		: hxb
	  Modification	: 初版驱动
	  					
*/

#include <stdio.h>
#include <string.h>
#include <assert.h>
#include "hi_comm_sns.h"
#include "hi_comm_video.h"
#include "hi_sns_ctrl.h"
#include "mpi_isp.h"
#include "mpi_ae.h"
#include "mpi_awb.h"
#include "mpi_af.h"

#include "bg0806.h"
#ifdef __cplusplus
#if __cplusplus
extern "C"{
#endif
#endif /* End of #ifdef __cplusplus */


#define BG0806_ID 0x0806

#define TEXPH_INDEX 			0
#define TEXPL_INDEX 			1
#define VREF_INDEX 				2
#define DGAINH_INDEX 			3
#define DGAINL_INDEX 			4
#define VBLANKH_INDEX 			5
#define VBLANKL_INDEX 			6
#define REG_2B_INDEX			7
#define REG_30_INDEX			8
#define REG_34_INDEX			9
#define REG_4D_INDEX			10
#define REG_4F_INDEX			11
#define REG_61_INDEX			12
#define REG_67_INDEX			13
#define REG_68_INDEX			14
#define REG_31_INDEX			15
#define REG_35_INDEX			16
#define REG_62_INDEX			17
#define REG_9e_INDEX			18
#define RESTART_INDEX 			19
#define REG_NUM					20


// Local define

#define TROW         	(ROWTIME*1000.0/PCLK)
#define LINE_PER_500MS  (500000/TROW)

#define PORCH        	(8)
#define VBLANK_Std   	((1000000/(FRAME_RATE*TROW)-(PORCH+VSIZE)))
#define VBLANK_5fps  	((1000000/(5*TROW)-(PORCH+VSIZE)))

#define MAXINT_Std   	(VSIZE+VBLANK_Std+PORCH)
#define MAXINT_5fps  	(VSIZE+VBLANK_5fps+PORCH)
#define INCREASE_LINES (1) /* make real fps less than stand fps because NVR require*/

#define VMAX_BG0806_1080P30_LINEAR (MAXINT_Std)

//Limit AGain to 1-13
#define VREFH_LIMIT_H 	0x7F
#define VREFH_LIMIT_L 	0x0c
#define MAX_AGAIN		((128/(VREFH_LIMIT_L+1))*1024)
#define MIN_AGAIN		((128/(VREFH_LIMIT_H+1))*1024)
#define MAX_DGAIN		((4096+255)/256)*1024
#define MIN_DGAIN		(0x180/0x100)*1024

/****************************************************************************
 * local variables                                                            *
 ****************************************************************************/

#define FULL_LINES_MAX  (0xFFF)

extern const unsigned int sensor_i2c_addr;
extern unsigned int sensor_addr_byte;
extern unsigned int sensor_data_byte;

#define SENSOR_1080P_30FPS_MODE (1)


HI_U8 gu8SensorImageMode = SENSOR_1080P_30FPS_MODE;
WDR_MODE_E genSensorMode = WDR_MODE_NONE;

static HI_U32 gu32FullLinesStd = VMAX_BG0806_1080P30_LINEAR;
static HI_U32 gu32FullLines = VMAX_BG0806_1080P30_LINEAR;

static HI_BOOL bInit = HI_FALSE;
HI_BOOL bSensorInit = HI_FALSE;
ISP_SNS_REGS_INFO_S g_stSnsRegsInfo = {0};
ISP_SNS_REGS_INFO_S g_stPreSnsRegsInfo = {0};

/* Piris attr */
static ISP_PIRIS_ATTR_S gstPirisAttr=
{
    0,      // bStepFNOTableChange
    1,      // bZeroIsMax
    93,     // u16TotalStep
    62,     // u16StepCount
    /* Step-F number mapping table. Must be from small to large. F1.0 is 1024 and F32.0 is 1 */
    {30,35,40,45,50,56,61,67,73,79,85,92,98,105,112,120,127,135,143,150,158,166,174,183,191,200,208,217,225,234,243,252,261,270,279,289,298,307,316,325,335,344,353,362,372,381,390,399,408,417,426,435,444,453,462,470,478,486,493,500,506,512},
    ISP_IRIS_F_NO_1_4, // enMaxIrisFNOTarget
    ISP_IRIS_F_NO_5_6  // enMinIrisFNOTarget
};



/* AE default parameter and function */
static HI_S32 cmos_get_ae_default(AE_SENSOR_DEFAULT_S *pstAeSnsDft)
{
    if (HI_NULL == pstAeSnsDft)
    {
        printf("null pointer when get ae default value!\n");
        return -1;
    }

    pstAeSnsDft->u32LinesPer500ms = gu32FullLinesStd * 30 / 2;
    pstAeSnsDft->u32FullLinesStd = gu32FullLinesStd;
    pstAeSnsDft->u32FlickerFreq = 0;
    pstAeSnsDft->u32FullLinesMax = FULL_LINES_MAX;

    pstAeSnsDft->au8HistThresh[0] = 0xd;
    pstAeSnsDft->au8HistThresh[1] = 0x28;
    pstAeSnsDft->au8HistThresh[2] = 0x60;
    pstAeSnsDft->au8HistThresh[3] = 0x80;
            
    pstAeSnsDft->u8AeCompensation = 0x40;

    pstAeSnsDft->stIntTimeAccu.enAccuType = AE_ACCURACY_LINEAR;
    pstAeSnsDft->stIntTimeAccu.f32Accuracy = 1;
    pstAeSnsDft->stIntTimeAccu.f32Offset = 0;
    pstAeSnsDft->u32MaxIntTime = gu32FullLinesStd - 2;
    pstAeSnsDft->u32MinIntTime = 2;
    pstAeSnsDft->u32MaxIntTimeTarget = 65535;
    pstAeSnsDft->u32MinIntTimeTarget = pstAeSnsDft->u32MinIntTime;


    pstAeSnsDft->stAgainAccu.enAccuType = AE_ACCURACY_TABLE;
    pstAeSnsDft->stAgainAccu.f32Accuracy = 1024; /* 62 / 0.0009765625= 63488 */
    pstAeSnsDft->u32MaxAgain = 10082;
    pstAeSnsDft->u32MinAgain = 1024;
    pstAeSnsDft->u32MaxAgainTarget = pstAeSnsDft->u32MaxAgain;
    pstAeSnsDft->u32MinAgainTarget = pstAeSnsDft->u32MinAgain;

    pstAeSnsDft->stDgainAccu.enAccuType = AE_ACCURACY_TABLE;
    pstAeSnsDft->stDgainAccu.f32Accuracy = 1024;
    pstAeSnsDft->u32MaxDgain = 8191;    //16x
    pstAeSnsDft->u32MinDgain = 1024;
    pstAeSnsDft->u32MaxDgainTarget = pstAeSnsDft->u32MaxDgain;
    pstAeSnsDft->u32MinDgainTarget = pstAeSnsDft->u32MinDgain; 
    
    pstAeSnsDft->u32ISPDgainShift = 8;
    pstAeSnsDft->u32MinISPDgainTarget = 1 << pstAeSnsDft->u32ISPDgainShift;
    pstAeSnsDft->u32MaxISPDgainTarget = 16 << pstAeSnsDft->u32ISPDgainShift; 

    pstAeSnsDft->enIrisType = ISP_IRIS_DC_TYPE;
    memcpy(&pstAeSnsDft->stPirisAttr, &gstPirisAttr, sizeof(ISP_PIRIS_ATTR_S));
    pstAeSnsDft->enMaxIrisFNO = ISP_IRIS_F_NO_1_4;
    pstAeSnsDft->enMinIrisFNO = ISP_IRIS_F_NO_5_6;

    pstAeSnsDft->u8AERunInterval = 1;

    return 0;
}

/* the function of sensor set fps */
static HI_VOID cmos_fps_set(HI_FLOAT f32Fps, AE_SENSOR_DEFAULT_S *pstAeSnsDft)
{
    HI_U32 u32Vsync=40;
	HI_U32 u32IntTime;
	
    printf("===================>>BG0806  Fps: %f,TROW=%f\n", f32Fps,TROW);
    if ((f32Fps <= 30) && (f32Fps >= 8.1))
    {
        if(SENSOR_1080P_30FPS_MODE == gu8SensorImageMode)
        {
            gu32FullLinesStd = VMAX_BG0806_1080P30_LINEAR * 30 / f32Fps;
            gu32FullLinesStd = (gu32FullLinesStd > FULL_LINES_MAX) ? FULL_LINES_MAX : gu32FullLinesStd;
            printf("===================>>BG0806  gu32FullLinesStd: %d\n", gu32FullLinesStd);
            
            u32Vsync = gu32FullLinesStd - 1088;
            g_stSnsRegsInfo.astI2cData[VBLANKH_INDEX].u32Data = (u32Vsync >> 8);      //vb h
            g_stSnsRegsInfo.astI2cData[VBLANKL_INDEX].u32Data = (u32Vsync  & 0xFF);   //vb l 
            
            pstAeSnsDft->u32MaxIntTime = gu32FullLinesStd - 2;
			u32IntTime = ((g_stSnsRegsInfo.astI2cData[0].u32Data & 0xff)<<8) | (g_stSnsRegsInfo.astI2cData[0].u32Data & 0xff);
			if(u32IntTime > pstAeSnsDft->u32MaxIntTime)
			{
				u32IntTime = pstAeSnsDft->u32MaxIntTime;
				g_stSnsRegsInfo.astI2cData[TEXPH_INDEX].u32Data = (u32IntTime >>8);
				g_stSnsRegsInfo.astI2cData[TEXPL_INDEX].u32Data = (u32IntTime & 0xff);
			}
        }
    }
    else
    {
        printf("Not support Fps: %f\n", f32Fps);
        return;
    }
	
    pstAeSnsDft->f32Fps = f32Fps;
    pstAeSnsDft->u32LinesPer500ms = gu32FullLinesStd * f32Fps / 2;
    pstAeSnsDft->u32FullLinesStd = gu32FullLinesStd;
    gu32FullLines = gu32FullLinesStd;
	pstAeSnsDft->u32FullLines = gu32FullLines;

    return;
}

static HI_VOID cmos_slow_framerate_set(HI_U32 u32FullLines,
    AE_SENSOR_DEFAULT_S *pstAeSnsDft)
{ 
    HI_U32 u32Vsync=40;
	HI_U32 u32IntTime;
	
	printf("===================>>BG0806 slow framerate FullLines: %d\n", u32FullLines);
	
    u32FullLines = (u32FullLines > FULL_LINES_MAX) ? FULL_LINES_MAX : u32FullLines;
    gu32FullLines = u32FullLines;
	pstAeSnsDft->u32FullLines = gu32FullLines;
	pstAeSnsDft->u32MaxIntTime = gu32FullLines - 2;

	u32IntTime = ((g_stSnsRegsInfo.astI2cData[0].u32Data & 0xff)<<8) | (g_stSnsRegsInfo.astI2cData[0].u32Data & 0xff);
	if(u32IntTime > pstAeSnsDft->u32MaxIntTime)
	{
		u32IntTime = pstAeSnsDft->u32MaxIntTime;
		g_stSnsRegsInfo.astI2cData[TEXPH_INDEX].u32Data = (u32IntTime >>8);
		g_stSnsRegsInfo.astI2cData[TEXPL_INDEX].u32Data = (u32IntTime & 0xff);
	}
	
    u32Vsync = gu32FullLines - 1088;
    g_stSnsRegsInfo.astI2cData[VBLANKH_INDEX].u32Data = (u32Vsync >> 8);      //vb h
    g_stSnsRegsInfo.astI2cData[VBLANKL_INDEX].u32Data = (u32Vsync  & 0xFF);   //vb l  


	return;
}

/* while isp notify ae to update sensor regs, ae call these funcs. */
static HI_VOID cmos_inttime_update(HI_U32 u32IntTime)
{
    //printf(">>>>>>>u32IntTime: %d\n", u32IntTime);
    //HI_U32 u32Value;
    //u32Value = gu32FullLines - 1 - u32IntTime;
    g_stSnsRegsInfo.astI2cData[TEXPH_INDEX].u32Data = (u32IntTime >> 8);
    g_stSnsRegsInfo.astI2cData[TEXPL_INDEX].u32Data = (u32IntTime  & 0xFF);
    
    g_stSnsRegsInfo.astI2cData[RESTART_INDEX].u32Data = 0x02;

    return;
}

static HI_U32 analog_gain_table[116] =
{
	1024, 1032, 1040, 1049, 1057, 1066, 1074, 1083, 1092, 1101, 1111, 
	1120, 1130, 1140, 1150, 1160, 1170, 1181, 1192, 1202, 1214, 1225, 
	1237, 1248, 1260, 1273, 1285, 1298, 1311, 1324, 1337, 1351, 1365, 
	1380, 1394, 1409, 1425, 1440, 1456, 1473, 1489, 1507, 1524, 1542, 
	1560, 1579, 1598, 1618, 1638, 1659, 1680, 1702, 1725, 1748, 1771, 
	1796, 1820, 1846, 1872, 1900, 1928, 1956, 1986, 2016, 2048, 2081, 
	2114, 2149, 2185, 2222, 2260, 2300, 2341, 2383, 2427, 2473, 2521, 
	2570, 2621, 2675, 2731, 2789, 2849, 2913, 2979, 3048, 3121, 3197, 
	3277, 3361, 3449, 3542, 3641, 3745, 3855, 3972, 4096, 4228, 4369, 
	4520, 4681, 4855, 5041, 5243, 5461, 5699, 5958, 6242, 6554, 6899, 
	7282, 7710, 8192, 8738, 9362, 10082
};

static HI_VOID cmos_again_calc_table(HI_U32 *pu32AgainLin, HI_U32 *pu32AgainDb)
{
    int i;

    if (*pu32AgainLin >= analog_gain_table[115])
    {
         *pu32AgainLin = analog_gain_table[115];
         *pu32AgainDb = 115;
         return ;
    }
    
    for (i = 1; i < 116; i++)
    {
        if (*pu32AgainLin < analog_gain_table[i])
        {
            *pu32AgainLin = analog_gain_table[i - 1];
            *pu32AgainDb = i - 1;
            break;
        }
    }

    return;

}

static HI_VOID cmos_dgain_calc_table(HI_U32 *pu32DgainLin, HI_U32 *pu32DgainDb)
{
	
    if (*pu32DgainLin > 8192){*pu32DgainLin = 8192;}  //max 8x dgain
	if (*pu32DgainLin < 1024){*pu32DgainLin = 1024;}

	*pu32DgainDb = (*pu32DgainLin*512)/1024;

//	printf("dgain reg = %d\n",*pu32DgainDb);
    return;
}

HI_U8	vrefh_min_tlb = 0x0c;

/*
	宏开关SW_VREF为动态调整最大模拟增益开关
	1、当定义SW_VREF时，系统会根据dark average(温度相关)
		来动态调整sensor能达到的最大模拟增益
	2、默认是不定义宏开关SW_VREF，最大模拟增益的值为
		Again = 128/(vref+1)，其中Vref固定为0x0c
*/
//#define SW_VREF	

#ifdef SW_VREF

struct stVrefh{
  HI_U16 index;
  HI_U16 th_low;
  HI_U16 th_high;
  unsigned char vrefh;
};

const struct stVrefh stVrefhTable[] =
{
	{5, 263, 267, 0x22},
	{4, 216, 220, 0x1c},
	{3, 176, 180, 0x17},
	{2, 130, 134, 0x12},
	{1, 113, 117, 0x10}
};

static HI_U8 pre_index = 0;

#endif
static HI_VOID cmos_gains_update(HI_U32 u32Again, HI_U32 u32Dgain)
{ 
	HI_U8 Vrefh;
	HI_U8 u8DgainHigh, u8DgainLow;
	HI_U8 reg_0x2b,reg_0x67,reg_0x68,reg_0x4f,reg_0x9e;
	HI_U8 reg_0x30,reg_0x34,reg_0x4d,reg_0x61;
	HI_U8 reg_0x31,reg_0x35,reg_0x62;
    //printf("========u32Again = %d,u32Dgain = %d\n",u32Again,u32Dgain);

#ifdef SW_VREF
		HI_U32	dark_ave;
		HI_U8 RampGain;
		static HI_U8 VrefhPre;
		HI_U8 i;

		RampGain = 128/(VrefhPre+1);
		dark_ave = ((sensor_read_register(0x012b)&0xFF)<<8)|(sensor_read_register(0x012c)&0xFF);
		
		printf("dark_ave:%d,vrefh_min_tlb:%x\n",dark_ave,vrefh_min_tlb);
		
		if(dark_ave > 0xfff) dark_ave = 0;
		dark_ave = dark_ave /RampGain;
	
		if(dark_ave < stVrefhTable[4].th_low)
		{
			pre_index = 0;
			vrefh_min_tlb = 0x0c;
		}
		else
		{	
			for(i=0;i<5;i++)
			{
				if(pre_index < stVrefhTable[i].index && dark_ave > stVrefhTable[i].th_high)
				{
					pre_index = stVrefhTable[i].index;
					vrefh_min_tlb = stVrefhTable[i].vrefh;
					break;
				}
				else if(pre_index >  stVrefhTable[i].index && dark_ave < stVrefhTable[i].th_low)
				{
					pre_index = stVrefhTable[i].index;
					vrefh_min_tlb = stVrefhTable[i].vrefh;	
					break;
				}
			}	
		}	
#endif	

	if (u32Dgain > 4095){u32Dgain = 4095;}		//max 8x dgain
	if (u32Dgain < 512){u32Dgain = 512;}

    u8DgainHigh = (u32Dgain >>8) & 0x0f;    
    u8DgainLow = (u32Dgain & 0xff);
    Vrefh = (1024*128 / analog_gain_table[u32Again]) - 1;
	if(Vrefh < vrefh_min_tlb ) Vrefh = vrefh_min_tlb;

	if(Vrefh == vrefh_min_tlb){
		reg_0x2b = 0x10;reg_0x30 = 0x01;
		reg_0x34 = 0x01;reg_0x4d = 0x03;
		reg_0x4f = 0x0c;reg_0x61 = 0x02;
		reg_0x67 = 0x00;reg_0x68 = 0x80;
		
		reg_0x31 = 0xd0;reg_0x35 = 0xd0;
		reg_0x62 = 0x5c;reg_0x9e = 0x03;
	}
	else{
		reg_0x2b = 0x30;reg_0x30 = 0x00;
		reg_0x34 = 0x00;reg_0x4d = 0x00;
		reg_0x4f = 0x09;reg_0x61 = 0x04;
		reg_0x67 = 0x01;reg_0x68 = 0x90;
		reg_0x31 = 0xd0;reg_0x35 = 0xd0;
		reg_0x62 = 0x5c;reg_0x9e = 0x03;
	}

	g_stSnsRegsInfo.astI2cData[REG_31_INDEX].u32Data = reg_0x31;
	g_stSnsRegsInfo.astI2cData[REG_35_INDEX].u32Data = reg_0x35;
	g_stSnsRegsInfo.astI2cData[REG_30_INDEX].u32Data = reg_0x30;
	g_stSnsRegsInfo.astI2cData[REG_34_INDEX].u32Data = reg_0x34;
	g_stSnsRegsInfo.astI2cData[REG_4D_INDEX].u32Data = reg_0x4d;
	g_stSnsRegsInfo.astI2cData[REG_61_INDEX].u32Data = reg_0x61;
	g_stSnsRegsInfo.astI2cData[REG_62_INDEX].u32Data = reg_0x62;

	g_stSnsRegsInfo.astI2cData[REG_2B_INDEX].u32Data = reg_0x2b;
	g_stSnsRegsInfo.astI2cData[REG_4F_INDEX].u32Data = reg_0x4f;
	g_stSnsRegsInfo.astI2cData[REG_67_INDEX].u32Data = reg_0x67;
	g_stSnsRegsInfo.astI2cData[REG_68_INDEX].u32Data = reg_0x68;
	g_stSnsRegsInfo.astI2cData[REG_9e_INDEX].u32Data = reg_0x9e;
	
    g_stSnsRegsInfo.astI2cData[VREF_INDEX].u32Data 	 = Vrefh;
    g_stSnsRegsInfo.astI2cData[DGAINH_INDEX].u32Data = u8DgainHigh;
    g_stSnsRegsInfo.astI2cData[DGAINL_INDEX].u32Data = u8DgainLow;
    g_stSnsRegsInfo.astI2cData[RESTART_INDEX].u32Data = 0x02;

#ifdef SW_VREF
	VrefhPre = Vrefh;
#endif

    return;
}

HI_S32 cmos_init_ae_exp_function(AE_SENSOR_EXP_FUNC_S *pstExpFuncs)
{
    memset(pstExpFuncs, 0, sizeof(AE_SENSOR_EXP_FUNC_S));

    pstExpFuncs->pfn_cmos_get_ae_default    = cmos_get_ae_default;
    pstExpFuncs->pfn_cmos_fps_set           = cmos_fps_set;
    pstExpFuncs->pfn_cmos_slow_framerate_set= cmos_slow_framerate_set;    
    pstExpFuncs->pfn_cmos_inttime_update    = cmos_inttime_update;
    pstExpFuncs->pfn_cmos_gains_update      = cmos_gains_update;
    pstExpFuncs->pfn_cmos_again_calc_table  = cmos_again_calc_table;
    pstExpFuncs->pfn_cmos_dgain_calc_table  = cmos_dgain_calc_table;

    return 0;
}


/* AWB default parameter and function */
static AWB_CCM_S g_stAwbCcm =
{
    4920,
    {  
        0x1FC,0x80AD,0x804F,        
        0x8045,0x1C5,0x8080,
        0x11,0x8141,0x230
    },
    3880,
    {   
        0x1B1,0x809E,0x8013,      
        0x8035,0x147,0x8012,
        0x1F,0x8145,0x226
    },
    2650,
    {   
        0x11F,0x8003,0x801C,
        0x80BE,0x1BD,0x1,
        0x8061,0x81C2,0x323 
    }
};

static AWB_AGC_TABLE_S g_stAwbAgcTable =
{
    /* bvalid */
    1,
	
    /*1,  2,  4,  8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768*/
    /* saturation */   
    {0x80,0x80,0x7a,0x78,0x70,0x68,0x60,0x58,0x50,0x48,0x40,0x38,0x38,0x38,0x38,0x38}

};

static HI_S32 cmos_get_awb_default(AWB_SENSOR_DEFAULT_S *pstAwbSnsDft)
{
    if (HI_NULL == pstAwbSnsDft)
    {
        printf("null pointer when get awb default value!\n");
        return -1;
    }

    memset(pstAwbSnsDft, 0, sizeof(AWB_SENSOR_DEFAULT_S));

    pstAwbSnsDft->u16WbRefTemp = 4910;

    pstAwbSnsDft->au16GainOffset[0] = 0x187;
    pstAwbSnsDft->au16GainOffset[1] = 0x100;
    pstAwbSnsDft->au16GainOffset[2] = 0x100;
    pstAwbSnsDft->au16GainOffset[3] = 0x16b;

    pstAwbSnsDft->as32WbPara[0] = 109;
    pstAwbSnsDft->as32WbPara[1] = 29;
    pstAwbSnsDft->as32WbPara[2] = -118;
    pstAwbSnsDft->as32WbPara[3] = 166324;
    pstAwbSnsDft->as32WbPara[4] = 128;
    pstAwbSnsDft->as32WbPara[5] = -113703;

    memcpy(&pstAwbSnsDft->stCcm, &g_stAwbCcm, sizeof(AWB_CCM_S));
    memcpy(&pstAwbSnsDft->stAgcTbl, &g_stAwbAgcTable, sizeof(AWB_AGC_TABLE_S));
    
    return 0;
}

HI_S32 cmos_init_awb_exp_function(AWB_SENSOR_EXP_FUNC_S *pstExpFuncs)
{
    memset(pstExpFuncs, 0, sizeof(AWB_SENSOR_EXP_FUNC_S));

    pstExpFuncs->pfn_cmos_get_awb_default = cmos_get_awb_default;

    return 0;
}

#define DMNR_CALIB_CARVE_NUM_BG0806 9

float g_coef_calib_bg0806[DMNR_CALIB_CARVE_NUM_BG0806][4] = 
{  
    {100.000000f, 2.000000f, 0.036470f, 6.872425f, }, 
    {200.000000f, 2.301030f, 0.039808f, 6.327385f, }, 
    {400.000000f, 2.602060f, 0.041653f, 6.645809f, }, 
    {800.000000f, 2.903090f, 0.043177f, 7.786633f, }, 
    {1600.000000f, 3.204120f, 0.046225f, 8.775841f, }, 
    {3200.000000f, 3.505150f, 0.058395f, 9.478638f, }, 
    {6200.000000f, 3.792392f, 0.062279f, 16.687279f, }, 
    {12400.000000f, 4.093422f, 0.073368f, 27.761475f, }, 
    {24800.000000f, 4.394452f, 0.088682f, 46.984421f, },   

};



static ISP_NR_ISO_PARA_TABLE_S g_stNrIsoParaTab[HI_ISP_NR_ISO_LEVEL_MAX] = 
{
     //u16Threshold//u8varStrength//u8fixStrength//u8LowFreqSlope	
       {500,       40,            256-256,            0 },  //100    //                      //                                                
       {500,       50,            256-256,            0 },  //200    // ISO                  // ISO //u8LowFreqSlope
       {600,       50,            256-256,            0 },  //400    //{400,  1200, 96,256}, //{400 , 0  }
       {700,       60,            256-256,            0 },  //800    //{800,  1400, 80,256}, //{600 , 2  }
       {800,       70,            256-256,            0 },  //1600   //{1600, 1200, 72,256}, //{800 , 8  }
       {900,       80,            256-256,            0 },  //3200   //{3200, 1200, 64,256}, //{1000, 12 }
       {1000,       90,            256-256,            0 },  //6400   //{6400, 1100, 56,256}, //{1600, 6  }
       {1100,       100,            256-256,            0 },  //12800  //{12000,1100, 48,256}, //{2400, 0  }
       {1200,       100,            256-256,            0 },  //25600  //{36000,1100, 48,256}, //
       {1200,       100,            256-256,            0 },  //51200  //{64000,1100, 96,256}, //
       {1200,       100,            256-256,            0 },  //102400 //{82000,1000,240,256}, //
       {1200,       100,            256-256,            0 },  //204800 //                           //
       {1200,       100,            256-256,            0 },  //409600 //                           //
       {1200,       100,            256-256,            0 },  //819200 //                           //
       {1200,       100,            256-256,            0 },  //1638400//                           //
       {1200,       100,            256-256,            0 },  //3276800//                           //
};

static ISP_CMOS_DEMOSAIC_S g_stIspDemosaic =
{
	/*For Demosaic*/
	1, /*bEnable*/			
	24,/*u16VhLimit*/	
	40-24,/*u16VhOffset*/
	24,   /*u16VhSlope*/
	/*False Color*/
	1,    /*bFcrEnable*/
	{ 8, 8, 8, 8, 8, 8, 8, 8, 3, 0, 0, 0, 0, 0, 0, 0},    /*au8FcrStrength[ISP_AUTO_ISO_STENGTH_NUM]*/
	{24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24},    /*au8FcrThreshold[ISP_AUTO_ISO_STENGTH_NUM]*/
	/*For Ahd*/
	400, /*u16UuSlope*/	
	{512,512,512,512,512,512,512,  400,  0,0,0,0,0,0,0,0}    /*au16NpOffset[ISP_AUTO_ISO_STENGTH_NUM]*/
};

static ISP_CMOS_GE_S g_stIspGe =
{
	/*For GE*/
	1,    /*bEnable*/			
	7,    /*u8Slope*/	
	7,    /*u8Sensitivity*/
	8192, /*u16Threshold*/
	8192, /*u16SensiThreshold*/	
	{1024,1024,1024,2048,2048,2048,2048,  2048,  2048,2048,2048,2048,2048,2048,2048,2048}    /*au16Strength[ISP_AUTO_ISO_STENGTH_NUM]*/	
};

static ISP_LSC_CABLI_UNI_TABLE_S g_stCmosLscUniTable = 
{
    /* Mesh Grid Info: Width */
    {14, 20, 27, 38, 54, 75, 105, 147},
    /* Mesh Grid Info: Height */
    {8, 11, 15, 22, 30, 42, 59, 83},
};

static ISP_LSC_CABLI_TABLE_S g_stCmosLscTable[HI_ISP_LSC_LIGHT_NUM] = 
{
    /* Light Source 1 */
    {
        /* AWB RGain */
        391,
        /* AWB BGain */
        478,
        /* Channel R */
        {

            19228588, 18817155, 18149137, 17332456, 16214859, 14992146, 13731593, 12504824, 11970196, 12595167, 13797311, 15071024, 16265108, 17363622, 18206949, 18831131, 19165009, 

            19161221, 18768296, 18094605, 17256776, 16188896, 14955639, 13698152, 12486791, 11923114, 12547635, 13768571, 15031527, 16235625, 17328508, 18156802, 18769294, 19058627, 

            18971309, 18613696, 17959599, 17089641, 16035787, 14846242, 13559602, 12398363, 11805563, 12441512, 13669105, 14892751, 16152878, 17158439, 17998762, 18639730, 18881471, 

            18693362, 18329663, 17715261, 16818220, 15801977, 14645183, 13367390, 12206681, 11614430, 12260076, 13501652, 14710544, 16212944, 17016179, 17735914, 18416510, 18721605, 

            18343195, 17966256, 17307156, 16499541, 15499548, 14324533, 13100540, 11962319, 11326123, 11993542, 13185508, 14439116, 16135587, 16991325, 17437108, 18053442, 18317168, 

            17687692, 17366245, 16793200, 15979296, 15021206, 13902176, 12702111, 11563605, 10904317, 11585391, 12783660, 14014563, 15365970, 16429361, 16965380, 17541475, 17833409, 

            17142911, 16799362, 16213795, 15454491, 14573223, 13464221, 12274015, 11080936, 10417419, 11154158, 12345517, 13547044, 14705731, 15651258, 16461580, 16984905, 17201241, 

            16806672, 16450079, 15898368, 15231201, 14328144, 13196136, 12009419, 10794918, 10107759, 10895594, 12183760, 13351759, 14457271, 15381650, 16170312, 16712706, 16973185, 

            16542047, 16215550, 15632009, 14911840, 14134276, 12947869, 11768218, 10572553, 10000000, 10662777, 11883367, 13077358, 14187530, 15083115, 15800462, 16384173, 16645187, 

            16874185, 16562773, 16004175, 15232422, 14388900, 13273224, 12125909, 10917512, 10260636, 10953114, 12197376, 13422733, 14619114, 15520226, 16223318, 16813530, 17023678, 

            17404269, 17059156, 16491341, 15747118, 14816656, 13678370, 12514129, 11371476, 10699813, 11409895, 12619052, 13910977, 15013133, 15995942, 16789436, 17300615, 17577708, 

            17844930, 17469330, 16868428, 16126588, 15191562, 14012141, 12806574, 11659375, 11086204, 11758339, 12965866, 14232988, 15367068, 16352418, 17096319, 17682189, 17976185, 

            18336597, 17962405, 17350217, 16584551, 15588489, 14395100, 13177565, 12050016, 11490614, 12168227, 13317988, 14582163, 15815726, 16779350, 17537181, 18164140, 18400129, 

            18832207, 18443027, 17797075, 16994771, 16088176, 14773578, 13550720, 12435097, 11850554, 12489440, 13699936, 14939867, 16197860, 17162251, 18012663, 18682131, 19019842, 

            19379478, 18872318, 18115555, 17300313, 16406899, 15126030, 13835767, 12679927, 12106313, 12763298, 13982816, 15243129, 16461580, 17507932, 18379540, 18986973, 19313164, 

            19659665, 19132452, 18377491, 17604684, 16610069, 15331377, 14014524, 12885878, 12307564, 12919854, 14195229, 15481736, 16696395, 17769762, 18651825, 19315050, 19663262, 

            19749425, 19246028, 18531996, 17742024, 16725879, 15432976, 14098365, 12978697, 12396312, 12983571, 14293598, 15595570, 16835400, 17920541, 18773784, 19460639, 19839292, 

        },

        /* Channel Gr */
        {

            19036009, 18620017, 17904538, 17123246, 16042329, 14839027, 13544711, 12425502, 11898719, 12469957, 13662205, 14930369, 16104020, 17045307, 17869065, 18536823, 18763272, 

            19009189, 18556098, 17888601, 17050605, 16010895, 14830740, 13533645, 12418977, 11872438, 12472374, 13636259, 14894513, 16105609, 17057994, 17866345, 18527329, 18745192, 

            18871370, 18413190, 17782882, 16928071, 15903369, 14760671, 13465863, 12340267, 11797322, 12409926, 13593078, 14791829, 16066208, 16972163, 17775278, 18408378, 18605108, 

            18619499, 18157494, 17549846, 16700539, 15702938, 14535382, 13292092, 12165290, 11605176, 12223129, 13455602, 14643010, 16093524, 16812226, 17526176, 18158628, 18324000, 

            18197686, 17809763, 17166644, 16358998, 15351154, 14198491, 12976283, 11908417, 11287237, 11945574, 13111615, 14324313, 15954706, 16810283, 17190456, 17802751, 18016950, 

            17638520, 17235350, 16571142, 15821553, 14909944, 13822890, 12623679, 11483736, 10892357, 11551529, 12712453, 13895535, 15193135, 16188986, 16696914, 17310785, 17497078, 

            17020423, 16619084, 16000712, 15293479, 14400944, 13356398, 12181212, 11030475, 10407362, 11121139, 12260280, 13440306, 14513253, 15418602, 16159979, 16743200, 16897382, 

            16651173, 16241911, 15736800, 15044388, 14146955, 13081091, 11887032, 10740941, 10096513, 10840816, 12054865, 13205327, 14292679, 15171435, 15899401, 16425289, 16576888, 

            16358798, 15996008, 15430690, 14744508, 13966528, 12813468, 11678897, 10514483, 10000000, 10642247, 11802232, 12962961, 13981468, 14815210, 15534604, 16076784, 16280912, 

            16668592, 16382666, 15826155, 15060877, 14203825, 13172653, 12056538, 10869623, 10226220, 10920066, 12095982, 13272110, 14389920, 15270899, 15960642, 16516093, 16658095, 

            17288335, 16914807, 16313655, 15581262, 14688101, 13645379, 12447273, 11314985, 10664226, 11352376, 12521006, 13769959, 14841529, 15740205, 16472066, 17011683, 17154894, 

            17774050, 17327324, 16765222, 16035756, 15135783, 13966674, 12725894, 11627376, 11069795, 11726046, 12861563, 14083392, 15184413, 16085672, 16802391, 17345693, 17499686, 

            18223355, 17872501, 17212077, 16412398, 15416791, 14252620, 13081346, 12021344, 11466755, 12095260, 13210201, 14449264, 15603969, 16533640, 17266879, 17905544, 18075933, 

            18724056, 18250042, 17536785, 16843667, 15905107, 14690003, 13496171, 12379531, 11837032, 12434830, 13597469, 14830938, 15990733, 16992461, 17780803, 18414203, 18631629, 

            19079100, 18527124, 17780236, 17061865, 16215818, 15017683, 13798806, 12652151, 12105675, 12701523, 13891930, 15154120, 16321414, 17354780, 18167846, 18800117, 19063122, 

            19331355, 18784866, 18041333, 17345288, 16554294, 15303866, 14043818, 12906062, 12349034, 12932799, 14149527, 15454495, 16645830, 17650756, 18516717, 19156216, 19402986, 

            19448209, 18907734, 18223504, 17510080, 16755399, 15471323, 14175213, 13042391, 12467494, 13070360, 14286089, 15624407, 16810452, 17807773, 18718190, 19348402, 19610117, 

        },

        /* Channel Gb */
        {

            19352082, 18875678, 18224539, 17415644, 16342352, 15105522, 13836095, 12628243, 12071378, 12729543, 13936295, 15226983, 16385081, 17389512, 18269650, 18903198, 19046348, 

            19352414, 18843306, 18193675, 17383125, 16314147, 15086532, 13800463, 12613088, 12053620, 12698232, 13920100, 15189597, 16391470, 17364973, 18229202, 18854802, 19031620, 

            19208895, 18733102, 18054193, 17253596, 16185982, 14976334, 13699233, 12539174, 11974861, 12627890, 13848042, 15089929, 16366221, 17277468, 18098416, 18736265, 18913393, 

            18888321, 18444658, 17788746, 16988253, 15943595, 14751369, 13497529, 12354732, 11765384, 12441122, 13679934, 14870348, 16369150, 17138689, 17827872, 18424975, 18639875, 

            18439633, 18034373, 17387814, 16592189, 15589178, 14417525, 13177675, 12048813, 11443730, 12135358, 13296321, 14547400, 16212852, 17076162, 17448060, 18022943, 18240108, 

            17855292, 17434486, 16804808, 16026236, 15052810, 13959779, 12770688, 11635309, 10997723, 11690416, 12881817, 14096579, 15391605, 16428552, 16940501, 17517425, 17740719, 

            17228605, 16836789, 16171325, 15476108, 14550841, 13468359, 12302339, 11127200, 10490346, 11235296, 12388880, 13615701, 14692989, 15624267, 16398181, 16922372, 17110742, 

            16805226, 16415920, 15873818, 15155244, 14276987, 13182346, 11998064, 10795947, 10130429, 10919369, 12136642, 13333464, 14421304, 15314844, 16080228, 16596339, 16764515, 

            16523528, 16090129, 15544709, 14786529, 14022716, 12867025, 11705985, 10520235, 10000000, 10661126, 11828965, 13005261, 14062311, 14914882, 15634986, 16171015, 16390120, 

            16829839, 16472495, 15901603, 15134741, 14246904, 13198748, 12032363, 10854730, 10210404, 10879962, 12091844, 13284811, 14405343, 15329413, 16001607, 16564129, 16733388, 

            17351395, 16959518, 16347405, 15602799, 14713368, 13622223, 12397254, 11258152, 10596778, 11306695, 12472049, 13681510, 14788662, 15717444, 16467765, 16998663, 17198048, 

            17850253, 17432510, 16790925, 16034893, 15088819, 13878056, 12653742, 11537525, 10976676, 11599634, 12783400, 14022628, 15111559, 16067630, 16824149, 17320844, 17485429, 

            18304831, 17914700, 17253024, 16369586, 15371924, 14214678, 13025108, 11914739, 11350478, 11999531, 13117935, 14344768, 15505145, 16435733, 17257071, 17828342, 18009515, 

            18756983, 18251864, 17522867, 16776857, 15826195, 14593479, 13393439, 12247929, 11720743, 12314830, 13441450, 14710426, 15902089, 16898585, 17706328, 18295825, 18563137, 

            19079422, 18523205, 17736256, 17021621, 16148406, 14908574, 13691058, 12515269, 11972319, 12561586, 13704420, 14994250, 16207882, 17210205, 18066048, 18687017, 18959806, 

            19347988, 18753345, 18029329, 17328915, 16479995, 15171381, 13940888, 12781637, 12189561, 12780696, 13984181, 15252307, 16509059, 17533762, 18463527, 19051602, 19301694, 

            19501521, 18911279, 18194898, 17546581, 16679900, 15318276, 14093907, 12941624, 12314942, 12896717, 14149744, 15401973, 16672176, 17724319, 18655082, 19250637, 19504162, 

        },

        /* Channel B */
        {

            18431019, 18140006, 17559140, 16896507, 15963761, 14924674, 13698288, 12617260, 12134986, 12806049, 13985896, 15111509, 16240921, 17241673, 17996299, 18600930, 18831347, 

            18387706, 18074954, 17506144, 16827245, 15886461, 14872201, 13653251, 12577933, 12079605, 12755899, 13910526, 15072287, 16186975, 17168792, 17928028, 18531574, 18768224, 

            18280277, 17949460, 17393843, 16648508, 15701818, 14705330, 13512155, 12459735, 11930814, 12617164, 13775657, 14936087, 16119083, 16965650, 17743839, 18345539, 18598992, 

            18042147, 17702689, 17148418, 16357227, 15464243, 14479623, 13292984, 12232184, 11716544, 12396469, 13570172, 14736710, 16144534, 16795252, 17480072, 18050028, 18286294, 

            17670032, 17344727, 16763662, 16073689, 15206461, 14178285, 13001250, 11979696, 11410103, 12108127, 13248813, 14404578, 15956170, 16828378, 17117420, 17713602, 17918327, 

            17081805, 16796832, 16295652, 15592378, 14722824, 13769928, 12639938, 11552091, 10978891, 11682625, 12850779, 14037137, 15267661, 16172629, 16646790, 17193707, 17417292, 

            16528748, 16276661, 15708774, 15095951, 14264728, 13282143, 12144094, 11075710, 10487112, 11230321, 12365076, 13523082, 14576460, 15425265, 16123761, 16696877, 16917431, 

            16238758, 15905260, 15415753, 14811798, 13972959, 12996485, 11877051, 10739811, 10140549, 10911112, 12150911, 13301152, 14274950, 15166745, 15815856, 16384242, 16585441, 

            15867252, 15591114, 15086977, 14465464, 13743093, 12693109, 11594685, 10481374, 10000000, 10625127, 11825281, 12969987, 13953812, 14797245, 15442320, 16012175, 16240657, 

            16215848, 15952658, 15471229, 14739142, 13935494, 12942658, 11875331, 10800921, 10192622, 10905876, 12077709, 13266918, 14339841, 15138549, 15781112, 16314049, 16563847, 

            16590504, 16327954, 15865188, 15131998, 14340170, 13357831, 12239550, 11186276, 10610741, 11322715, 12477334, 13659480, 14714721, 15556333, 16249049, 16767822, 16984784, 

            16982881, 16685064, 16159509, 15533087, 14664572, 13617665, 12541651, 11473703, 10983956, 11629339, 12774215, 13958876, 14995486, 15860558, 16512645, 17082389, 17322553, 

            17432474, 17139953, 16600915, 15883281, 14998680, 13962501, 12906642, 11855086, 11344475, 11997288, 13073763, 14246844, 15367991, 16241448, 16951960, 17555933, 17824236, 

            17907545, 17522709, 16959608, 16320333, 15473431, 14347330, 13236502, 12154160, 11682188, 12295564, 13403021, 14585943, 15729876, 16621831, 17362917, 17983548, 18267720, 

            18230819, 17791825, 17145713, 16475482, 15737847, 14566777, 13449349, 12390786, 11905360, 12516189, 13657391, 14824050, 15959073, 16918748, 17642722, 18320734, 18681200, 

            18407880, 17981026, 17378548, 16686290, 15964985, 14760028, 13648481, 12582207, 12091904, 12702461, 13823187, 15021932, 16174355, 17160248, 17895367, 18584129, 18965781, 

            18518670, 18076849, 17507554, 16829964, 16102004, 14835178, 13770156, 12661640, 12193493, 12802737, 13910100, 15152864, 16333608, 17293256, 18015688, 18705102, 19047570, 

        },

    },
	/* Light Source 2 */
    {
        /* AWB RGain */
        391,
        /* AWB BGain */
        478,
        /* Channel R */
        {

            19228588, 18817155, 18149137, 17332456, 16214859, 14992146, 13731593, 12504824, 11970196, 12595167, 13797311, 15071024, 16265108, 17363622, 18206949, 18831131, 19165009, 

            19161221, 18768296, 18094605, 17256776, 16188896, 14955639, 13698152, 12486791, 11923114, 12547635, 13768571, 15031527, 16235625, 17328508, 18156802, 18769294, 19058627, 

            18971309, 18613696, 17959599, 17089641, 16035787, 14846242, 13559602, 12398363, 11805563, 12441512, 13669105, 14892751, 16152878, 17158439, 17998762, 18639730, 18881471, 

            18693362, 18329663, 17715261, 16818220, 15801977, 14645183, 13367390, 12206681, 11614430, 12260076, 13501652, 14710544, 16212944, 17016179, 17735914, 18416510, 18721605, 

            18343195, 17966256, 17307156, 16499541, 15499548, 14324533, 13100540, 11962319, 11326123, 11993542, 13185508, 14439116, 16135587, 16991325, 17437108, 18053442, 18317168, 

            17687692, 17366245, 16793200, 15979296, 15021206, 13902176, 12702111, 11563605, 10904317, 11585391, 12783660, 14014563, 15365970, 16429361, 16965380, 17541475, 17833409, 

            17142911, 16799362, 16213795, 15454491, 14573223, 13464221, 12274015, 11080936, 10417419, 11154158, 12345517, 13547044, 14705731, 15651258, 16461580, 16984905, 17201241, 

            16806672, 16450079, 15898368, 15231201, 14328144, 13196136, 12009419, 10794918, 10107759, 10895594, 12183760, 13351759, 14457271, 15381650, 16170312, 16712706, 16973185, 

            16542047, 16215550, 15632009, 14911840, 14134276, 12947869, 11768218, 10572553, 10000000, 10662777, 11883367, 13077358, 14187530, 15083115, 15800462, 16384173, 16645187, 

            16874185, 16562773, 16004175, 15232422, 14388900, 13273224, 12125909, 10917512, 10260636, 10953114, 12197376, 13422733, 14619114, 15520226, 16223318, 16813530, 17023678, 

            17404269, 17059156, 16491341, 15747118, 14816656, 13678370, 12514129, 11371476, 10699813, 11409895, 12619052, 13910977, 15013133, 15995942, 16789436, 17300615, 17577708, 

            17844930, 17469330, 16868428, 16126588, 15191562, 14012141, 12806574, 11659375, 11086204, 11758339, 12965866, 14232988, 15367068, 16352418, 17096319, 17682189, 17976185, 

            18336597, 17962405, 17350217, 16584551, 15588489, 14395100, 13177565, 12050016, 11490614, 12168227, 13317988, 14582163, 15815726, 16779350, 17537181, 18164140, 18400129, 

            18832207, 18443027, 17797075, 16994771, 16088176, 14773578, 13550720, 12435097, 11850554, 12489440, 13699936, 14939867, 16197860, 17162251, 18012663, 18682131, 19019842, 

            19379478, 18872318, 18115555, 17300313, 16406899, 15126030, 13835767, 12679927, 12106313, 12763298, 13982816, 15243129, 16461580, 17507932, 18379540, 18986973, 19313164, 

            19659665, 19132452, 18377491, 17604684, 16610069, 15331377, 14014524, 12885878, 12307564, 12919854, 14195229, 15481736, 16696395, 17769762, 18651825, 19315050, 19663262, 

            19749425, 19246028, 18531996, 17742024, 16725879, 15432976, 14098365, 12978697, 12396312, 12983571, 14293598, 15595570, 16835400, 17920541, 18773784, 19460639, 19839292, 

        },

        /* Channel Gr */
        {

            19036009, 18620017, 17904538, 17123246, 16042329, 14839027, 13544711, 12425502, 11898719, 12469957, 13662205, 14930369, 16104020, 17045307, 17869065, 18536823, 18763272, 

            19009189, 18556098, 17888601, 17050605, 16010895, 14830740, 13533645, 12418977, 11872438, 12472374, 13636259, 14894513, 16105609, 17057994, 17866345, 18527329, 18745192, 

            18871370, 18413190, 17782882, 16928071, 15903369, 14760671, 13465863, 12340267, 11797322, 12409926, 13593078, 14791829, 16066208, 16972163, 17775278, 18408378, 18605108, 

            18619499, 18157494, 17549846, 16700539, 15702938, 14535382, 13292092, 12165290, 11605176, 12223129, 13455602, 14643010, 16093524, 16812226, 17526176, 18158628, 18324000, 

            18197686, 17809763, 17166644, 16358998, 15351154, 14198491, 12976283, 11908417, 11287237, 11945574, 13111615, 14324313, 15954706, 16810283, 17190456, 17802751, 18016950, 

            17638520, 17235350, 16571142, 15821553, 14909944, 13822890, 12623679, 11483736, 10892357, 11551529, 12712453, 13895535, 15193135, 16188986, 16696914, 17310785, 17497078, 

            17020423, 16619084, 16000712, 15293479, 14400944, 13356398, 12181212, 11030475, 10407362, 11121139, 12260280, 13440306, 14513253, 15418602, 16159979, 16743200, 16897382, 

            16651173, 16241911, 15736800, 15044388, 14146955, 13081091, 11887032, 10740941, 10096513, 10840816, 12054865, 13205327, 14292679, 15171435, 15899401, 16425289, 16576888, 

            16358798, 15996008, 15430690, 14744508, 13966528, 12813468, 11678897, 10514483, 10000000, 10642247, 11802232, 12962961, 13981468, 14815210, 15534604, 16076784, 16280912, 

            16668592, 16382666, 15826155, 15060877, 14203825, 13172653, 12056538, 10869623, 10226220, 10920066, 12095982, 13272110, 14389920, 15270899, 15960642, 16516093, 16658095, 

            17288335, 16914807, 16313655, 15581262, 14688101, 13645379, 12447273, 11314985, 10664226, 11352376, 12521006, 13769959, 14841529, 15740205, 16472066, 17011683, 17154894, 

            17774050, 17327324, 16765222, 16035756, 15135783, 13966674, 12725894, 11627376, 11069795, 11726046, 12861563, 14083392, 15184413, 16085672, 16802391, 17345693, 17499686, 

            18223355, 17872501, 17212077, 16412398, 15416791, 14252620, 13081346, 12021344, 11466755, 12095260, 13210201, 14449264, 15603969, 16533640, 17266879, 17905544, 18075933, 

            18724056, 18250042, 17536785, 16843667, 15905107, 14690003, 13496171, 12379531, 11837032, 12434830, 13597469, 14830938, 15990733, 16992461, 17780803, 18414203, 18631629, 

            19079100, 18527124, 17780236, 17061865, 16215818, 15017683, 13798806, 12652151, 12105675, 12701523, 13891930, 15154120, 16321414, 17354780, 18167846, 18800117, 19063122, 

            19331355, 18784866, 18041333, 17345288, 16554294, 15303866, 14043818, 12906062, 12349034, 12932799, 14149527, 15454495, 16645830, 17650756, 18516717, 19156216, 19402986, 

            19448209, 18907734, 18223504, 17510080, 16755399, 15471323, 14175213, 13042391, 12467494, 13070360, 14286089, 15624407, 16810452, 17807773, 18718190, 19348402, 19610117, 

        },

        /* Channel Gb */
        {

            19352082, 18875678, 18224539, 17415644, 16342352, 15105522, 13836095, 12628243, 12071378, 12729543, 13936295, 15226983, 16385081, 17389512, 18269650, 18903198, 19046348, 

            19352414, 18843306, 18193675, 17383125, 16314147, 15086532, 13800463, 12613088, 12053620, 12698232, 13920100, 15189597, 16391470, 17364973, 18229202, 18854802, 19031620, 

            19208895, 18733102, 18054193, 17253596, 16185982, 14976334, 13699233, 12539174, 11974861, 12627890, 13848042, 15089929, 16366221, 17277468, 18098416, 18736265, 18913393, 

            18888321, 18444658, 17788746, 16988253, 15943595, 14751369, 13497529, 12354732, 11765384, 12441122, 13679934, 14870348, 16369150, 17138689, 17827872, 18424975, 18639875, 

            18439633, 18034373, 17387814, 16592189, 15589178, 14417525, 13177675, 12048813, 11443730, 12135358, 13296321, 14547400, 16212852, 17076162, 17448060, 18022943, 18240108, 

            17855292, 17434486, 16804808, 16026236, 15052810, 13959779, 12770688, 11635309, 10997723, 11690416, 12881817, 14096579, 15391605, 16428552, 16940501, 17517425, 17740719, 

            17228605, 16836789, 16171325, 15476108, 14550841, 13468359, 12302339, 11127200, 10490346, 11235296, 12388880, 13615701, 14692989, 15624267, 16398181, 16922372, 17110742, 

            16805226, 16415920, 15873818, 15155244, 14276987, 13182346, 11998064, 10795947, 10130429, 10919369, 12136642, 13333464, 14421304, 15314844, 16080228, 16596339, 16764515, 

            16523528, 16090129, 15544709, 14786529, 14022716, 12867025, 11705985, 10520235, 10000000, 10661126, 11828965, 13005261, 14062311, 14914882, 15634986, 16171015, 16390120, 

            16829839, 16472495, 15901603, 15134741, 14246904, 13198748, 12032363, 10854730, 10210404, 10879962, 12091844, 13284811, 14405343, 15329413, 16001607, 16564129, 16733388, 

            17351395, 16959518, 16347405, 15602799, 14713368, 13622223, 12397254, 11258152, 10596778, 11306695, 12472049, 13681510, 14788662, 15717444, 16467765, 16998663, 17198048, 

            17850253, 17432510, 16790925, 16034893, 15088819, 13878056, 12653742, 11537525, 10976676, 11599634, 12783400, 14022628, 15111559, 16067630, 16824149, 17320844, 17485429, 

            18304831, 17914700, 17253024, 16369586, 15371924, 14214678, 13025108, 11914739, 11350478, 11999531, 13117935, 14344768, 15505145, 16435733, 17257071, 17828342, 18009515, 

            18756983, 18251864, 17522867, 16776857, 15826195, 14593479, 13393439, 12247929, 11720743, 12314830, 13441450, 14710426, 15902089, 16898585, 17706328, 18295825, 18563137, 

            19079422, 18523205, 17736256, 17021621, 16148406, 14908574, 13691058, 12515269, 11972319, 12561586, 13704420, 14994250, 16207882, 17210205, 18066048, 18687017, 18959806, 

            19347988, 18753345, 18029329, 17328915, 16479995, 15171381, 13940888, 12781637, 12189561, 12780696, 13984181, 15252307, 16509059, 17533762, 18463527, 19051602, 19301694, 

            19501521, 18911279, 18194898, 17546581, 16679900, 15318276, 14093907, 12941624, 12314942, 12896717, 14149744, 15401973, 16672176, 17724319, 18655082, 19250637, 19504162, 

        },

        /* Channel B */
        {

            18431019, 18140006, 17559140, 16896507, 15963761, 14924674, 13698288, 12617260, 12134986, 12806049, 13985896, 15111509, 16240921, 17241673, 17996299, 18600930, 18831347, 

            18387706, 18074954, 17506144, 16827245, 15886461, 14872201, 13653251, 12577933, 12079605, 12755899, 13910526, 15072287, 16186975, 17168792, 17928028, 18531574, 18768224, 

            18280277, 17949460, 17393843, 16648508, 15701818, 14705330, 13512155, 12459735, 11930814, 12617164, 13775657, 14936087, 16119083, 16965650, 17743839, 18345539, 18598992, 

            18042147, 17702689, 17148418, 16357227, 15464243, 14479623, 13292984, 12232184, 11716544, 12396469, 13570172, 14736710, 16144534, 16795252, 17480072, 18050028, 18286294, 

            17670032, 17344727, 16763662, 16073689, 15206461, 14178285, 13001250, 11979696, 11410103, 12108127, 13248813, 14404578, 15956170, 16828378, 17117420, 17713602, 17918327, 

            17081805, 16796832, 16295652, 15592378, 14722824, 13769928, 12639938, 11552091, 10978891, 11682625, 12850779, 14037137, 15267661, 16172629, 16646790, 17193707, 17417292, 

            16528748, 16276661, 15708774, 15095951, 14264728, 13282143, 12144094, 11075710, 10487112, 11230321, 12365076, 13523082, 14576460, 15425265, 16123761, 16696877, 16917431, 

            16238758, 15905260, 15415753, 14811798, 13972959, 12996485, 11877051, 10739811, 10140549, 10911112, 12150911, 13301152, 14274950, 15166745, 15815856, 16384242, 16585441, 

            15867252, 15591114, 15086977, 14465464, 13743093, 12693109, 11594685, 10481374, 10000000, 10625127, 11825281, 12969987, 13953812, 14797245, 15442320, 16012175, 16240657, 

            16215848, 15952658, 15471229, 14739142, 13935494, 12942658, 11875331, 10800921, 10192622, 10905876, 12077709, 13266918, 14339841, 15138549, 15781112, 16314049, 16563847, 

            16590504, 16327954, 15865188, 15131998, 14340170, 13357831, 12239550, 11186276, 10610741, 11322715, 12477334, 13659480, 14714721, 15556333, 16249049, 16767822, 16984784, 

            16982881, 16685064, 16159509, 15533087, 14664572, 13617665, 12541651, 11473703, 10983956, 11629339, 12774215, 13958876, 14995486, 15860558, 16512645, 17082389, 17322553, 

            17432474, 17139953, 16600915, 15883281, 14998680, 13962501, 12906642, 11855086, 11344475, 11997288, 13073763, 14246844, 15367991, 16241448, 16951960, 17555933, 17824236, 

            17907545, 17522709, 16959608, 16320333, 15473431, 14347330, 13236502, 12154160, 11682188, 12295564, 13403021, 14585943, 15729876, 16621831, 17362917, 17983548, 18267720, 

            18230819, 17791825, 17145713, 16475482, 15737847, 14566777, 13449349, 12390786, 11905360, 12516189, 13657391, 14824050, 15959073, 16918748, 17642722, 18320734, 18681200, 

            18407880, 17981026, 17378548, 16686290, 15964985, 14760028, 13648481, 12582207, 12091904, 12702461, 13823187, 15021932, 16174355, 17160248, 17895367, 18584129, 18965781, 

            18518670, 18076849, 17507554, 16829964, 16102004, 14835178, 13770156, 12661640, 12193493, 12802737, 13910100, 15152864, 16333608, 17293256, 18015688, 18705102, 19047570, 

        },

    },
	/* Light Source 3 */
    {
        /* AWB RGain */
        391,
        /* AWB BGain */
        478,
        /* Channel R */
        {

            19228588, 18817155, 18149137, 17332456, 16214859, 14992146, 13731593, 12504824, 11970196, 12595167, 13797311, 15071024, 16265108, 17363622, 18206949, 18831131, 19165009, 

            19161221, 18768296, 18094605, 17256776, 16188896, 14955639, 13698152, 12486791, 11923114, 12547635, 13768571, 15031527, 16235625, 17328508, 18156802, 18769294, 19058627, 

            18971309, 18613696, 17959599, 17089641, 16035787, 14846242, 13559602, 12398363, 11805563, 12441512, 13669105, 14892751, 16152878, 17158439, 17998762, 18639730, 18881471, 

            18693362, 18329663, 17715261, 16818220, 15801977, 14645183, 13367390, 12206681, 11614430, 12260076, 13501652, 14710544, 16212944, 17016179, 17735914, 18416510, 18721605, 

            18343195, 17966256, 17307156, 16499541, 15499548, 14324533, 13100540, 11962319, 11326123, 11993542, 13185508, 14439116, 16135587, 16991325, 17437108, 18053442, 18317168, 

            17687692, 17366245, 16793200, 15979296, 15021206, 13902176, 12702111, 11563605, 10904317, 11585391, 12783660, 14014563, 15365970, 16429361, 16965380, 17541475, 17833409, 

            17142911, 16799362, 16213795, 15454491, 14573223, 13464221, 12274015, 11080936, 10417419, 11154158, 12345517, 13547044, 14705731, 15651258, 16461580, 16984905, 17201241, 

            16806672, 16450079, 15898368, 15231201, 14328144, 13196136, 12009419, 10794918, 10107759, 10895594, 12183760, 13351759, 14457271, 15381650, 16170312, 16712706, 16973185, 

            16542047, 16215550, 15632009, 14911840, 14134276, 12947869, 11768218, 10572553, 10000000, 10662777, 11883367, 13077358, 14187530, 15083115, 15800462, 16384173, 16645187, 

            16874185, 16562773, 16004175, 15232422, 14388900, 13273224, 12125909, 10917512, 10260636, 10953114, 12197376, 13422733, 14619114, 15520226, 16223318, 16813530, 17023678, 

            17404269, 17059156, 16491341, 15747118, 14816656, 13678370, 12514129, 11371476, 10699813, 11409895, 12619052, 13910977, 15013133, 15995942, 16789436, 17300615, 17577708, 

            17844930, 17469330, 16868428, 16126588, 15191562, 14012141, 12806574, 11659375, 11086204, 11758339, 12965866, 14232988, 15367068, 16352418, 17096319, 17682189, 17976185, 

            18336597, 17962405, 17350217, 16584551, 15588489, 14395100, 13177565, 12050016, 11490614, 12168227, 13317988, 14582163, 15815726, 16779350, 17537181, 18164140, 18400129, 

            18832207, 18443027, 17797075, 16994771, 16088176, 14773578, 13550720, 12435097, 11850554, 12489440, 13699936, 14939867, 16197860, 17162251, 18012663, 18682131, 19019842, 

            19379478, 18872318, 18115555, 17300313, 16406899, 15126030, 13835767, 12679927, 12106313, 12763298, 13982816, 15243129, 16461580, 17507932, 18379540, 18986973, 19313164, 

            19659665, 19132452, 18377491, 17604684, 16610069, 15331377, 14014524, 12885878, 12307564, 12919854, 14195229, 15481736, 16696395, 17769762, 18651825, 19315050, 19663262, 

            19749425, 19246028, 18531996, 17742024, 16725879, 15432976, 14098365, 12978697, 12396312, 12983571, 14293598, 15595570, 16835400, 17920541, 18773784, 19460639, 19839292, 

        },

        /* Channel Gr */
        {

            19036009, 18620017, 17904538, 17123246, 16042329, 14839027, 13544711, 12425502, 11898719, 12469957, 13662205, 14930369, 16104020, 17045307, 17869065, 18536823, 18763272, 

            19009189, 18556098, 17888601, 17050605, 16010895, 14830740, 13533645, 12418977, 11872438, 12472374, 13636259, 14894513, 16105609, 17057994, 17866345, 18527329, 18745192, 

            18871370, 18413190, 17782882, 16928071, 15903369, 14760671, 13465863, 12340267, 11797322, 12409926, 13593078, 14791829, 16066208, 16972163, 17775278, 18408378, 18605108, 

            18619499, 18157494, 17549846, 16700539, 15702938, 14535382, 13292092, 12165290, 11605176, 12223129, 13455602, 14643010, 16093524, 16812226, 17526176, 18158628, 18324000, 

            18197686, 17809763, 17166644, 16358998, 15351154, 14198491, 12976283, 11908417, 11287237, 11945574, 13111615, 14324313, 15954706, 16810283, 17190456, 17802751, 18016950, 

            17638520, 17235350, 16571142, 15821553, 14909944, 13822890, 12623679, 11483736, 10892357, 11551529, 12712453, 13895535, 15193135, 16188986, 16696914, 17310785, 17497078, 

            17020423, 16619084, 16000712, 15293479, 14400944, 13356398, 12181212, 11030475, 10407362, 11121139, 12260280, 13440306, 14513253, 15418602, 16159979, 16743200, 16897382, 

            16651173, 16241911, 15736800, 15044388, 14146955, 13081091, 11887032, 10740941, 10096513, 10840816, 12054865, 13205327, 14292679, 15171435, 15899401, 16425289, 16576888, 

            16358798, 15996008, 15430690, 14744508, 13966528, 12813468, 11678897, 10514483, 10000000, 10642247, 11802232, 12962961, 13981468, 14815210, 15534604, 16076784, 16280912, 

            16668592, 16382666, 15826155, 15060877, 14203825, 13172653, 12056538, 10869623, 10226220, 10920066, 12095982, 13272110, 14389920, 15270899, 15960642, 16516093, 16658095, 

            17288335, 16914807, 16313655, 15581262, 14688101, 13645379, 12447273, 11314985, 10664226, 11352376, 12521006, 13769959, 14841529, 15740205, 16472066, 17011683, 17154894, 

            17774050, 17327324, 16765222, 16035756, 15135783, 13966674, 12725894, 11627376, 11069795, 11726046, 12861563, 14083392, 15184413, 16085672, 16802391, 17345693, 17499686, 

            18223355, 17872501, 17212077, 16412398, 15416791, 14252620, 13081346, 12021344, 11466755, 12095260, 13210201, 14449264, 15603969, 16533640, 17266879, 17905544, 18075933, 

            18724056, 18250042, 17536785, 16843667, 15905107, 14690003, 13496171, 12379531, 11837032, 12434830, 13597469, 14830938, 15990733, 16992461, 17780803, 18414203, 18631629, 

            19079100, 18527124, 17780236, 17061865, 16215818, 15017683, 13798806, 12652151, 12105675, 12701523, 13891930, 15154120, 16321414, 17354780, 18167846, 18800117, 19063122, 

            19331355, 18784866, 18041333, 17345288, 16554294, 15303866, 14043818, 12906062, 12349034, 12932799, 14149527, 15454495, 16645830, 17650756, 18516717, 19156216, 19402986, 

            19448209, 18907734, 18223504, 17510080, 16755399, 15471323, 14175213, 13042391, 12467494, 13070360, 14286089, 15624407, 16810452, 17807773, 18718190, 19348402, 19610117, 

        },

        /* Channel Gb */
        {

            19352082, 18875678, 18224539, 17415644, 16342352, 15105522, 13836095, 12628243, 12071378, 12729543, 13936295, 15226983, 16385081, 17389512, 18269650, 18903198, 19046348, 

            19352414, 18843306, 18193675, 17383125, 16314147, 15086532, 13800463, 12613088, 12053620, 12698232, 13920100, 15189597, 16391470, 17364973, 18229202, 18854802, 19031620, 

            19208895, 18733102, 18054193, 17253596, 16185982, 14976334, 13699233, 12539174, 11974861, 12627890, 13848042, 15089929, 16366221, 17277468, 18098416, 18736265, 18913393, 

            18888321, 18444658, 17788746, 16988253, 15943595, 14751369, 13497529, 12354732, 11765384, 12441122, 13679934, 14870348, 16369150, 17138689, 17827872, 18424975, 18639875, 

            18439633, 18034373, 17387814, 16592189, 15589178, 14417525, 13177675, 12048813, 11443730, 12135358, 13296321, 14547400, 16212852, 17076162, 17448060, 18022943, 18240108, 

            17855292, 17434486, 16804808, 16026236, 15052810, 13959779, 12770688, 11635309, 10997723, 11690416, 12881817, 14096579, 15391605, 16428552, 16940501, 17517425, 17740719, 

            17228605, 16836789, 16171325, 15476108, 14550841, 13468359, 12302339, 11127200, 10490346, 11235296, 12388880, 13615701, 14692989, 15624267, 16398181, 16922372, 17110742, 

            16805226, 16415920, 15873818, 15155244, 14276987, 13182346, 11998064, 10795947, 10130429, 10919369, 12136642, 13333464, 14421304, 15314844, 16080228, 16596339, 16764515, 

            16523528, 16090129, 15544709, 14786529, 14022716, 12867025, 11705985, 10520235, 10000000, 10661126, 11828965, 13005261, 14062311, 14914882, 15634986, 16171015, 16390120, 

            16829839, 16472495, 15901603, 15134741, 14246904, 13198748, 12032363, 10854730, 10210404, 10879962, 12091844, 13284811, 14405343, 15329413, 16001607, 16564129, 16733388, 

            17351395, 16959518, 16347405, 15602799, 14713368, 13622223, 12397254, 11258152, 10596778, 11306695, 12472049, 13681510, 14788662, 15717444, 16467765, 16998663, 17198048, 

            17850253, 17432510, 16790925, 16034893, 15088819, 13878056, 12653742, 11537525, 10976676, 11599634, 12783400, 14022628, 15111559, 16067630, 16824149, 17320844, 17485429, 

            18304831, 17914700, 17253024, 16369586, 15371924, 14214678, 13025108, 11914739, 11350478, 11999531, 13117935, 14344768, 15505145, 16435733, 17257071, 17828342, 18009515, 

            18756983, 18251864, 17522867, 16776857, 15826195, 14593479, 13393439, 12247929, 11720743, 12314830, 13441450, 14710426, 15902089, 16898585, 17706328, 18295825, 18563137, 

            19079422, 18523205, 17736256, 17021621, 16148406, 14908574, 13691058, 12515269, 11972319, 12561586, 13704420, 14994250, 16207882, 17210205, 18066048, 18687017, 18959806, 

            19347988, 18753345, 18029329, 17328915, 16479995, 15171381, 13940888, 12781637, 12189561, 12780696, 13984181, 15252307, 16509059, 17533762, 18463527, 19051602, 19301694, 

            19501521, 18911279, 18194898, 17546581, 16679900, 15318276, 14093907, 12941624, 12314942, 12896717, 14149744, 15401973, 16672176, 17724319, 18655082, 19250637, 19504162, 

        },

        /* Channel B */
        {

            18431019, 18140006, 17559140, 16896507, 15963761, 14924674, 13698288, 12617260, 12134986, 12806049, 13985896, 15111509, 16240921, 17241673, 17996299, 18600930, 18831347, 

            18387706, 18074954, 17506144, 16827245, 15886461, 14872201, 13653251, 12577933, 12079605, 12755899, 13910526, 15072287, 16186975, 17168792, 17928028, 18531574, 18768224, 

            18280277, 17949460, 17393843, 16648508, 15701818, 14705330, 13512155, 12459735, 11930814, 12617164, 13775657, 14936087, 16119083, 16965650, 17743839, 18345539, 18598992, 

            18042147, 17702689, 17148418, 16357227, 15464243, 14479623, 13292984, 12232184, 11716544, 12396469, 13570172, 14736710, 16144534, 16795252, 17480072, 18050028, 18286294, 

            17670032, 17344727, 16763662, 16073689, 15206461, 14178285, 13001250, 11979696, 11410103, 12108127, 13248813, 14404578, 15956170, 16828378, 17117420, 17713602, 17918327, 

            17081805, 16796832, 16295652, 15592378, 14722824, 13769928, 12639938, 11552091, 10978891, 11682625, 12850779, 14037137, 15267661, 16172629, 16646790, 17193707, 17417292, 

            16528748, 16276661, 15708774, 15095951, 14264728, 13282143, 12144094, 11075710, 10487112, 11230321, 12365076, 13523082, 14576460, 15425265, 16123761, 16696877, 16917431, 

            16238758, 15905260, 15415753, 14811798, 13972959, 12996485, 11877051, 10739811, 10140549, 10911112, 12150911, 13301152, 14274950, 15166745, 15815856, 16384242, 16585441, 

            15867252, 15591114, 15086977, 14465464, 13743093, 12693109, 11594685, 10481374, 10000000, 10625127, 11825281, 12969987, 13953812, 14797245, 15442320, 16012175, 16240657, 

            16215848, 15952658, 15471229, 14739142, 13935494, 12942658, 11875331, 10800921, 10192622, 10905876, 12077709, 13266918, 14339841, 15138549, 15781112, 16314049, 16563847, 

            16590504, 16327954, 15865188, 15131998, 14340170, 13357831, 12239550, 11186276, 10610741, 11322715, 12477334, 13659480, 14714721, 15556333, 16249049, 16767822, 16984784, 

            16982881, 16685064, 16159509, 15533087, 14664572, 13617665, 12541651, 11473703, 10983956, 11629339, 12774215, 13958876, 14995486, 15860558, 16512645, 17082389, 17322553, 

            17432474, 17139953, 16600915, 15883281, 14998680, 13962501, 12906642, 11855086, 11344475, 11997288, 13073763, 14246844, 15367991, 16241448, 16951960, 17555933, 17824236, 

            17907545, 17522709, 16959608, 16320333, 15473431, 14347330, 13236502, 12154160, 11682188, 12295564, 13403021, 14585943, 15729876, 16621831, 17362917, 17983548, 18267720, 

            18230819, 17791825, 17145713, 16475482, 15737847, 14566777, 13449349, 12390786, 11905360, 12516189, 13657391, 14824050, 15959073, 16918748, 17642722, 18320734, 18681200, 

            18407880, 17981026, 17378548, 16686290, 15964985, 14760028, 13648481, 12582207, 12091904, 12702461, 13823187, 15021932, 16174355, 17160248, 17895367, 18584129, 18965781, 

            18518670, 18076849, 17507554, 16829964, 16102004, 14835178, 13770156, 12661640, 12193493, 12802737, 13910100, 15152864, 16333608, 17293256, 18015688, 18705102, 19047570, 

        },

    }
};


static ISP_CMOS_RGBSHARPEN_S g_stIspRgbSharpen =
{      
  //{100,200,400,800,1600,3200,6400,12800,25600,51200,102400,204800,409600,819200,1638400,3276800};
    {0,	  0,   0,   0,    0,   0,   0,   0,    1,    1,    1,     1,     1,     1,     1,       1},/* enPixSel = ~bEnLowLumaShoot */
        
    {116,  110,  105,  100,  92,  84,  76,  65,    18,  200,  250,   250,   250,   250,    250,    250},/*maxSharpAmt1 = SharpenUD*16 */
    {128, 122, 116, 104,  96,  90,  80,  80,    80,  250,  250,   250,   250,   250,    250,    250},/*maxEdgeAmt = SharpenD*16 */
        
    {0,   0,   0,    0,   0,   0,   0,   40,  190,  200,  220,   250,   250,   250,     250,       250},/*sharpThd2 = TextureNoiseThd*4 */
    {0,   0,   0,    0,   0,   0,   0,   60,  140,    0,    0,     0,    0,     0,     0,       0},/*edgeThd2 = EdgeNoiseThd*4 */
    {48,  48,  48,  48,  48,  48,  48,   48,  48,  0,   0,    0,   0,    0,    0,      0},/*overshootAmt*/
    {90, 90, 85, 85, 80, 80, 80,  80, 80,  0,   0,    0,   0,    0,    0,     0},/*undershootAmt*/
};


static ISP_CMOS_UVNR_S g_stIspUVNR = 
{
  //{100,	200,	400,	800,	1600,	3200,	6400,	12800,	25600,	51200,	102400,	204800,	409600,	819200,	1638400,	3276800};
	{1,	    2,       4,      5,      7,      48,     32,     16,     16,     16,      16,     16,     16,     16,     16,        16},      /*UVNRThreshold*/
 	{0,		0,		0,		0,		0,		0,		0,		0,		0,		1,			1,		2,		2,		2,		2,		2},  /*Coring_lutLimit*/
	{0,		0,		0,		16,		34,		34,		34,		34,		34,		34,		34,		34,		34,		34,		34,			34}  /*UVNR_blendRatio*/
};

static ISP_CMOS_DPC_S g_stCmosDpc = 
{
	//1,/*IR_channel*/
	//1,/*IR_position*/
	{0,0,0,1,1,1,2,2,2,3,3,3,3,3,3,3},/*au16Strength[16]*/
	{0,0,0,0,0,0,0,0,0x24,0x80,0x80,0x80,0xE5,0xE5,0xE5,0xE5},/*au16BlendRatio[16]*/
};

static ISP_CMOS_DRC_S g_stIspDrc =
{
    0,
    10,
    0,
    2,
    192,
    60,
    0,
    0,
    0,
    {1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024,1024}
};

HI_U32 cmos_get_isp_default(ISP_CMOS_DEFAULT_S *pstDef)
{
    if (HI_NULL == pstDef)
    {
        printf("null pointer when get isp default value!\n");
        return -1;
    }

    memset(pstDef, 0, sizeof(ISP_CMOS_DEFAULT_S));
	memcpy(&pstDef->stLsc.stLscUniParaTable, &g_stCmosLscUniTable, sizeof(ISP_LSC_CABLI_UNI_TABLE_S));
    memcpy(&pstDef->stLsc.stLscParaTable[0], &g_stCmosLscTable[0], sizeof(ISP_LSC_CABLI_TABLE_S)*HI_ISP_LSC_LIGHT_NUM);
    memcpy(&pstDef->stDemosaic, &g_stIspDemosaic, sizeof(ISP_CMOS_DEMOSAIC_S));
    memcpy(&pstDef->stRgbSharpen, &g_stIspRgbSharpen, sizeof(ISP_CMOS_RGBSHARPEN_S));
    memcpy(&pstDef->stGe, &g_stIspGe, sizeof(ISP_CMOS_GE_S));			
	memcpy(&pstDef->stDrc, &g_stIspDrc, sizeof(ISP_CMOS_DRC_S));	
    pstDef->stNoiseTbl.stNrCaliPara.u8CalicoefRow = DMNR_CALIB_CARVE_NUM_BG0806;
    pstDef->stNoiseTbl.stNrCaliPara.pCalibcoef    = (HI_FLOAT (*)[4])g_coef_calib_bg0806;

    memcpy(&pstDef->stNoiseTbl.stIsoParaTable[0], &g_stNrIsoParaTab[0],sizeof(ISP_NR_ISO_PARA_TABLE_S)*HI_ISP_NR_ISO_LEVEL_MAX);

    memcpy(&pstDef->stUvnr,       &g_stIspUVNR,       sizeof(ISP_CMOS_UVNR_S));
    memcpy(&pstDef->stDpc,       &g_stCmosDpc,       sizeof(ISP_CMOS_DPC_S));
	

    pstDef->stSensorMaxResolution.u32MaxWidth  = 1920;
    pstDef->stSensorMaxResolution.u32MaxHeight = 1080;

    return 0;
}

HI_U32 cmos_get_isp_black_level(ISP_CMOS_BLACK_LEVEL_S *pstBlackLevel)
{
    if (HI_NULL == pstBlackLevel)
    {
        printf("null pointer when get isp black level value!\n");
        return -1;
    }

    /* Don't need to update black level when iso change */
    pstBlackLevel->bUpdate = HI_FALSE;
          
    pstBlackLevel->au16BlackLevel[0] = 11;
    pstBlackLevel->au16BlackLevel[1] = 11;
    pstBlackLevel->au16BlackLevel[2] = 11;
    pstBlackLevel->au16BlackLevel[3] = 11;
    

    return 0;  
    
}

HI_VOID cmos_set_pixel_detect(HI_BOOL bEnable)
{
	if (bEnable) /* setup for ISP pixel calibration mode */
    {
        /* 5 fps */		
        g_stSnsRegsInfo.astI2cData[VBLANKH_INDEX].u32Data = (HI_U32)VBLANK_5fps >> 8;
    	g_stSnsRegsInfo.astI2cData[VBLANKL_INDEX].u32Data = (HI_U32)VBLANK_5fps  & 0xFF;
		
	 	/* min again */
		g_stSnsRegsInfo.astI2cData[VREF_INDEX].u32Data = 0x7f;
		
		/* min dgain */
		g_stSnsRegsInfo.astI2cData[DGAINH_INDEX].u32Data = 0x02;
    	g_stSnsRegsInfo.astI2cData[DGAINL_INDEX].u32Data = 0x00;
		
		/* max exposure time*/	
		g_stSnsRegsInfo.astI2cData[TEXPH_INDEX].u32Data = ((HI_U32)MAXINT_5fps-2) >> 8;
    	g_stSnsRegsInfo.astI2cData[TEXPL_INDEX].u32Data = ((HI_U32)MAXINT_5fps-2)  & 0xFF;
    }        
    else /* setup for ISP 'normal mode' */
    {
        /* 30 fps */		
        g_stSnsRegsInfo.astI2cData[VBLANKH_INDEX].u32Data = (HI_U32)VBLANK_Std >> 8;
    	g_stSnsRegsInfo.astI2cData[VBLANKL_INDEX].u32Data = (HI_U32)VBLANK_Std  & 0xFF;
    }
	
    return;
}

HI_VOID cmos_set_wdr_mode(HI_U8 u8Mode)
{
    bInit = HI_FALSE;
    
    switch(u8Mode)
    {
        case WDR_MODE_NONE:
            if (SENSOR_1080P_30FPS_MODE == gu8SensorImageMode)
            {
                gu32FullLinesStd = VMAX_BG0806_1080P30_LINEAR;
            }
            genSensorMode = WDR_MODE_NONE;
            printf("linear mode\n");
        break;
        default:
            printf("NOT support this mode!\n");
            return;
        break;
    }
    
    return;
}

HI_U32 cmos_get_sns_regs_info(ISP_SNS_REGS_INFO_S *pstSnsRegsInfo)
{
    HI_S32 i;

    if (HI_FALSE == bInit)
    {
        g_stSnsRegsInfo.enSnsType = ISP_SNS_I2C_TYPE;
        g_stSnsRegsInfo.u8Cfg2ValidDelayMax = 2;		
        g_stSnsRegsInfo.u32RegNum = REG_NUM;
		
        for (i = 0; i < g_stSnsRegsInfo.u32RegNum; i++)
        {	
            g_stSnsRegsInfo.astI2cData[i].bUpdate = HI_TRUE;
            g_stSnsRegsInfo.astI2cData[i].u8DevAddr = sensor_i2c_addr;
            g_stSnsRegsInfo.astI2cData[i].u32AddrByteNum = sensor_addr_byte;
            g_stSnsRegsInfo.astI2cData[i].u32DataByteNum = sensor_data_byte;
			g_stSnsRegsInfo.astI2cData[i].u8DelayFrmNum = 0;
        }

        g_stSnsRegsInfo.astI2cData[TEXPH_INDEX].u32RegAddr = 0x000c;    //integration time h
        g_stSnsRegsInfo.astI2cData[TEXPL_INDEX].u32RegAddr = 0x000d;    //integration time l
        g_stSnsRegsInfo.astI2cData[VREF_INDEX].u32RegAddr = 0x00b1;    //vrefl1
        g_stSnsRegsInfo.astI2cData[DGAINH_INDEX].u32RegAddr = 0x00bc;    //[3:0]->digital gain[11:8] h
        g_stSnsRegsInfo.astI2cData[DGAINL_INDEX].u32RegAddr = 0x00bd;    //[7:0]digital gain[7:0] l

        g_stSnsRegsInfo.astI2cData[VBLANKH_INDEX].u32RegAddr = 0x0021;    //VB h
        g_stSnsRegsInfo.astI2cData[VBLANKL_INDEX].u32RegAddr = 0x0022;    //VB l

		g_stSnsRegsInfo.astI2cData[REG_30_INDEX].u32RegAddr = 0x0030;	 
		g_stSnsRegsInfo.astI2cData[REG_34_INDEX].u32RegAddr = 0x0034;	  
		g_stSnsRegsInfo.astI2cData[REG_4D_INDEX].u32RegAddr = 0x004D;	 
		g_stSnsRegsInfo.astI2cData[REG_61_INDEX].u32RegAddr = 0x0061;	 
		g_stSnsRegsInfo.astI2cData[REG_31_INDEX].u32RegAddr = 0x0031;	 
		g_stSnsRegsInfo.astI2cData[REG_35_INDEX].u32RegAddr = 0x0035;	  
		g_stSnsRegsInfo.astI2cData[REG_62_INDEX].u32RegAddr = 0x0062;	 
	
		g_stSnsRegsInfo.astI2cData[REG_4F_INDEX].u32RegAddr = 0x004F;	
		g_stSnsRegsInfo.astI2cData[REG_2B_INDEX].u32RegAddr = 0x002b;		
		g_stSnsRegsInfo.astI2cData[REG_67_INDEX].u32RegAddr = 0x0067;	  
		g_stSnsRegsInfo.astI2cData[REG_68_INDEX].u32RegAddr = 0x0068;	
		g_stSnsRegsInfo.astI2cData[REG_9e_INDEX].u32RegAddr = 0x009e;	 

        g_stSnsRegsInfo.astI2cData[RESTART_INDEX].u32RegAddr = 0x001d;    

        bInit = HI_TRUE;
    }   
    
    if (HI_NULL == pstSnsRegsInfo)
    {
        printf("null pointer when get sns reg info!\n");
        return -1;
    }
	
//	printf("initime:%d\n",g_stSnsRegsInfo.astI2cData[TEXPH_INDEX].u32Data*256+g_stSnsRegsInfo.astI2cData[TEXPL_INDEX].u32Data);
	
    memcpy(pstSnsRegsInfo, &g_stSnsRegsInfo, sizeof(ISP_SNS_REGS_INFO_S)); 
    memcpy(&g_stPreSnsRegsInfo, &g_stSnsRegsInfo, sizeof(ISP_SNS_REGS_INFO_S)); 

    return 0;
}

static HI_S32 cmos_set_image_mode(ISP_CMOS_SENSOR_IMAGE_MODE_S *pstSensorImageMode)
{
    HI_U8 u8SensorImageMode = gu8SensorImageMode;

    bInit = HI_FALSE;
    
    if (HI_NULL == pstSensorImageMode )
    {
        printf("null pointer when set image mode\n");
        return -1;
    }

    if ((pstSensorImageMode->u16Width <= 1920) && (pstSensorImageMode->u16Height <= 1080))
    {
        if (WDR_MODE_NONE == genSensorMode)
        {
            if (pstSensorImageMode->f32Fps <= 30)
            {
                u8SensorImageMode = SENSOR_1080P_30FPS_MODE;
            }
            else
            {
                printf("Not support! Width:%d, Height:%d, Fps:%f, WDRMode:%d\n", 
                    pstSensorImageMode->u16Width, 
                    pstSensorImageMode->u16Height,
                    pstSensorImageMode->f32Fps,
                    genSensorMode);

                return -1;
            }
        }
        else
        {
            printf("Not support! Width:%d, Height:%d, Fps:%f, WDRMode:%d\n", 
                pstSensorImageMode->u16Width, 
                pstSensorImageMode->u16Height,
                pstSensorImageMode->f32Fps,
                genSensorMode);

            return -1;
        }
    }
    else
    {
        printf("Not support! Width:%d, Height:%d, Fps:%f, WDRMode:%d\n", 
            pstSensorImageMode->u16Width, 
            pstSensorImageMode->u16Height,
            pstSensorImageMode->f32Fps,
            genSensorMode);

        return -1;
    }

    /* Sensor first init */
    if (HI_FALSE == bSensorInit)
    {
        gu8SensorImageMode = u8SensorImageMode;
        
        return 0;
    }

    /* Switch SensorImageMode */
    if (u8SensorImageMode == gu8SensorImageMode)
    {
        /* Don't need to switch SensorImageMode */
        return -1;
    }
    
    gu8SensorImageMode = u8SensorImageMode;

    return 0;
}

HI_VOID sensor_global_init()
{   
    gu8SensorImageMode = SENSOR_1080P_30FPS_MODE;
    genSensorMode = WDR_MODE_NONE;
    gu32FullLinesStd = VMAX_BG0806_1080P30_LINEAR; 
    gu32FullLines = VMAX_BG0806_1080P30_LINEAR;
    bInit = HI_FALSE;
    bSensorInit = HI_FALSE; 

    memset(&g_stSnsRegsInfo, 0, sizeof(ISP_SNS_REGS_INFO_S));
    memset(&g_stPreSnsRegsInfo, 0, sizeof(ISP_SNS_REGS_INFO_S));
}

HI_S32 cmos_init_sensor_exp_function(ISP_SENSOR_EXP_FUNC_S *pstSensorExpFunc)
{
    memset(pstSensorExpFunc, 0, sizeof(ISP_SENSOR_EXP_FUNC_S));

    pstSensorExpFunc->pfn_cmos_sensor_init = sensor_init;
    pstSensorExpFunc->pfn_cmos_sensor_exit = sensor_exit;
    pstSensorExpFunc->pfn_cmos_sensor_global_init = sensor_global_init;
    pstSensorExpFunc->pfn_cmos_set_image_mode = cmos_set_image_mode;
    pstSensorExpFunc->pfn_cmos_set_wdr_mode = cmos_set_wdr_mode;
    
    pstSensorExpFunc->pfn_cmos_get_isp_default = cmos_get_isp_default;
    pstSensorExpFunc->pfn_cmos_get_isp_black_level = cmos_get_isp_black_level;
    pstSensorExpFunc->pfn_cmos_set_pixel_detect = cmos_set_pixel_detect;
    pstSensorExpFunc->pfn_cmos_get_sns_reg_info = cmos_get_sns_regs_info;

    return 0;
}

/****************************************************************************
 * callback structure                                                       *
 ****************************************************************************/
 
int sensor_register_callback(void)
{
    ISP_DEV IspDev = 0;
    HI_S32 s32Ret;
    ALG_LIB_S stLib;
    ISP_SENSOR_REGISTER_S stIspRegister;
    AE_SENSOR_REGISTER_S  stAeRegister;
    AWB_SENSOR_REGISTER_S stAwbRegister;

    cmos_init_sensor_exp_function(&stIspRegister.stSnsExp);
    s32Ret = HI_MPI_ISP_SensorRegCallBack(IspDev, BG0806_ID, &stIspRegister);
    if (s32Ret)
    {
        printf("sensor register callback function failed!\n");
        return s32Ret;
    }
    
    stLib.s32Id = 0;
    strncpy(stLib.acLibName, HI_AE_LIB_NAME, sizeof(HI_AE_LIB_NAME));
    cmos_init_ae_exp_function(&stAeRegister.stSnsExp);
    s32Ret = HI_MPI_AE_SensorRegCallBack(IspDev, &stLib, BG0806_ID, &stAeRegister);
    if (s32Ret)
    {
        printf("sensor register callback function to ae lib failed!\n");
        return s32Ret;
    }

    stLib.s32Id = 0;
    strncpy(stLib.acLibName, HI_AWB_LIB_NAME, sizeof(HI_AWB_LIB_NAME));
    cmos_init_awb_exp_function(&stAwbRegister.stSnsExp);
    s32Ret = HI_MPI_AWB_SensorRegCallBack(IspDev, &stLib, BG0806_ID, &stAwbRegister);
    if (s32Ret)
    {
        printf("sensor register callback function to ae lib failed!\n");
        return s32Ret;
    }
    
    return 0;
}

int sensor_unregister_callback(void)
{
    ISP_DEV IspDev = 0;
    HI_S32 s32Ret;
    ALG_LIB_S stLib;

    s32Ret = HI_MPI_ISP_SensorUnRegCallBack(IspDev, BG0806_ID);
    if (s32Ret)
    {
        printf("sensor unregister callback function failed!\n");
        return s32Ret;
    }
    
    stLib.s32Id = 0;
    strncpy(stLib.acLibName, HI_AE_LIB_NAME, sizeof(HI_AE_LIB_NAME));
    s32Ret = HI_MPI_AE_SensorUnRegCallBack(IspDev, &stLib, BG0806_ID);
    if (s32Ret)
    {
        printf("sensor unregister callback function to ae lib failed!\n");
        return s32Ret;
    }

    stLib.s32Id = 0;
    strncpy(stLib.acLibName, HI_AWB_LIB_NAME, sizeof(HI_AWB_LIB_NAME));
    s32Ret = HI_MPI_AWB_SensorUnRegCallBack(IspDev, &stLib, BG0806_ID);
    if (s32Ret)
    {
        printf("sensor unregister callback function to ae lib failed!\n");
        return s32Ret;
    }
    
    return 0;
}

#ifdef __cplusplus
#if __cplusplus
}
#endif
#endif /* End of #ifdef __cplusplus */

#endif /* __SOIBG0803_CMOS_H_ */
